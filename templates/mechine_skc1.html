<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>title</title>
    <link rel="stylesheet" href="../static/css/css1.css" />
    <script type="text/javascript" src="../static/js/line-simple1.js"> </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-gl/dist/echarts-gl.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-stat/dist/ecStat.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/extension/dataTool.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/extension/bmap.min.js"></script>
    <script type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/echarts/4.8.0/echarts-en.common.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/Chart.js/1.1.0/Chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ace-builds@1.4.12/src-min-noconflict/ace.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dat.gui@0.6.5/build/dat.gui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/apache/echarts-website@asf-site/examples/js/example-bundle.js?_v_=4ed28896a8"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/Chart.js/1.1.0/Chart.min.js"></script>
</head>
<body>

<!--这里是头条-->
    <header>
        <div id="backheader">
            <ul id="navigation">
                <li><a href='/e2' style="position:absolute;left: 5%">电参数</a></li>
            </ul>
            <h id="meacheine_name">立式加工中心VMC850E</h>
            <div id="datetime">
                <script>
//setInterval() 方法可按照指定的周期（以毫秒计）来调用函数或计算表达式。
//getElementById() 方法可返回对拥有指定 ID 的第一个对象的引用。这里🆔id为datetime
//这里
                    setInterval("document.getElementById('datetime').innerHTML=new Date().toLocaleString();", 1000);
                </script>
            </div>
        </div>
    </header>

<!--这里是饼图-->
    <pie id="pie">
        <div type="text/javascript" id="pie1">
            <script type="text/javascript">
               pie_alltime()
            </script>
        </div>
        <div type="text/javascript" id="pie2">
            <script type="text/javascript">
                pie_worktime()
            </script>
        </div>
    </pie>

<!--这里是工艺参数-->
    <paramter id="para">
        <table id = "mytable" border="0">
            <tr>
            <tr>
                <th>零件名称</th>
                <th>零件批次</th>
                <th>零件流水号</th>
            </tr>
            <tr>
                <td>轴</td>
                <td>1</td>
                <td>0</td>
            </tr>
            </tr>
        </table>
        <script>
            //获取表格行数
            var x1=document.getElementById('mytable').rows[2].cells;
            var pici = 1;
            //定时改变内容
            setInterval(function() {
            if (pici <= 10){
                x1[1].innerHTML=pici;
                pici++;
            }
            else{
                x1[1].innerHTML=1;
                pici = 2;
            }
            },600000);
            var x2=document.getElementById('mytable').rows[2].cells;
            var liushuohao = 0;
            setInterval(function() {
            if (liushuohao <= 100){
                x2[2].innerHTML=liushuohao;
                liushuohao++;
            }
            else{
                x2[2].innerHTML=0;
                liushuohao = 1;
            }
            },6000);
        </script>
    </paramter>


<!--这里是表面质量-->

        <div id="surf_list"></div>

<!--这里是表面质量合格率-->
        <div id="surf_rate1" style="position:absolute;left:75%;top:62%;height: 300px;width: 400px">
            <script type="text/javascript">
                surface_rate1()
            </script>
        </div>




<!--这里是刀具使用时间-->
        <div  id="timetool">
            <script type="text/javascript">
                timeoftool()
            </script>
        </div>

        <div  id="toolwear" style="position:absolute;left:2%;top:35%;height: 25%;width: 25%;">

        </div>
<!--这里是刀具健康-->
<div  id="toolhealth">
    <script type="text/javascript">
        toolhealth()
    </script>
</div>


<!--这里是按钮-->
<div class="demo">
    <a href="#" class="button green small" onclick="zhengdong()" id="zhengdong">振动</a>
    <a href="#" class="button green small" onclick="Pchart()" id="gonghao">功耗</a>
</div>

<!--这里是功率与振动图表-->
    <data>
<!--
        <div class="container1">
           <ul id="leftNav">
                <script>one()</script>
                <li><a onclick="zhengdong()" id="zhengdong" class=>振动</a></li>
                <li><a onclick="Pchart()" id="gonghao">功耗</a></li>

            </ul>
        </div>

-->
        <div id="lintable1" style="position:absolute;left:30%;top:48%;width: 40%;height: 50%"></div>
        <div id="lintable2" style="position:absolute;left:30%;top:48%;width: 40%;height: 50%"></div>

        </data>

<script>
    var dom = document.getElementById("surf_rate1");
    var dom1 = document.getElementById("lintable2");
    var dom2 = document.getElementById("lintable1");
    var dom3 = document.getElementById("timetool");
    var dom4 = document.getElementById("pie1")
    var dom5 = document.getElementById("pie2")
    var dom6 = document.getElementById("toolhealth")
    var dom7 = document.getElementById("toolwear")
    var dom8 = document.getElementById("surf_list")
    var myChart = echarts.init(dom);
    var myChart1 = echarts.init(dom1);
    var myChart2 = echarts.init(dom2);
    var myChart3 = echarts.init(dom3);
    var myChart4 = echarts.init(dom4);
    var myChart5 = echarts.init(dom5);
    var myChart6 = echarts.init(dom6);
    var myChart7 = echarts.init(dom7);
    var myChart8 = echarts.init(dom8);
    var option
    var option1
    var option2
    var option3
    var option4
    var option5
    var option6
    var option7
    var option8
    $(function () {
        var hege = [0,0];
        // var shuzi = Math.random().toFixed(2)*100;
        // hege[0] = shuzi;
     option8 = {
    title: {
        x:'center',
        y:25,

        text: '加工工件数量',
		textStyle: {
			color:"#c23531",

			}

    },
    tooltip : {
        trigger: 'axis',
        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
    },
    grid: {
        left: '3%',
        right: '4%',
        bottom: '3%',
        containLabel: true
    },
    xAxis : [
        {
            type : 'category',
            data : ['合格', '不合格'],
            axisTick: {
                alignWithLabel: true
            }
        }
    ],
    yAxis : [
        {
            type : 'value',
            minInterval: 1,
        }
    ],
    series : [
        {
            type:'bar',
            barWidth: '40%',
            itemStyle: {
                normal: {
                    //数值显示在柱状上方
                    label:{
                    show:true,
                    position:'top',
                    textStyle:{
                        color:'black',
                        fontSize:16
                    }
                    },
                color: function(params) {
                    let colorList = [
                        "#3398DB",
                        "#c23531",
                    ];
                    return colorList[params.dataIndex];
                }},
            },
            data:hege
        }
    ]
    };
    myChart8.setOption(option8);
    setInterval(function(){
        if(hege[0] % 49 != 0 || hege[0] == 0){
            hege[0] += 1;
        }
        else if((hege[0] + hege[1]) % 49 == 0 && hege[0] + hege[1] != 1000){
            hege[0]+=1;
        }
        else if(hege[0] + hege[1] == 1000){
            hege[0] = 0;
            hege[1] = 0;
        }
        else if(hege[0] % 49 == 0 && hege[0] != 0){
            hege[1] += 1;
        }

    myChart8.setOption(option8);
    },6000);

    })


    {#功率按钮#}
    function Pchart() {
        var x1 = document.getElementById("lintable1");
        var x2 = document.getElementById("lintable2");
        var button1 = document.getElementById("zhendong");
        var button2 = document.getElementById("gonghao");
        x1.style.display = "none";
        x2.style.display = "inline";
    }
    {#振动按钮#}
    function zhengdong() {
        var x1 = document.getElementById("lintable1");
        var x2 = document.getElementById("lintable2");
        var button1 = document.getElementById("zhendong");
        var button2 = document.getElementById("gonghao");
        x1.style.display = "inline";
        x2.style.display = "none";

    }
    {#刀具磨损#}
    $(function () {
        var mosun = [2.2, 4.1, 1.6, 0.8, 0.7];
    option7 = {
    title:{
        text:"刀具后刀面磨损",
        x:'120px'

            },
    tooltip : {
            trigger: 'axis',
            axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
            }
        },
    xAxis: {
        type: 'category',
        data: ['外圆车刀1', '端面车刀2', '切断刀3', '螺纹车刀4', '成形车刀5']
    },
    yAxis: {
        name:'磨损度(mm)',
        max:"5",
        min:"0",
        type: 'value'
    },
    series: [{
        data: mosun,
        type: 'bar'
    }]

};
var j = 0;
var zhengdon = [0.11,0.931,0.102,0.115,0.091,0.124,0.112,0.097,0.141,0.016,  0.124,0.091,0.019,0.045,0,0.15,0.102,0.115,0.133,0.048,0.011,0.066,0.122,0.038,0.101,0.051,0.11,0.931,0.102,0.115,0.091,0.124,0.112,0.097,0.141,0.016,    0,0.121,0.038,0.123,0.045];
setInterval(function(){
    if (j<zhengdon.length){
        mosun.shift();
        mosun.unshift((400-1000*zhengdon[j])/100+1);
        j++;
    }
    else{
        mosun.shift();
        mosun.unshift(0.1*(400-1000*zhengdon[0]));
        j=1;
    }
    myChart7.setOption(option7);
},1000);

option7 && myChart7.setOption(option7);
    })
    {#刀具耐用度#}
    $(function () {
    var mosun = [100, 120, 300, 200, 350];
    const colors = ['#c23531','#2f4554', '#61a0a8', '#d48265', '#91c7ae','#749f83'];
    option6 = {
    title:{
        text:"刀具耐用度",
        x:'120px'

            },
    tooltip : {
            trigger: 'axis',
            axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
            }
        },
    xAxis: {
        type: 'value',

        max:400,
        min:0
    },
    yAxis: {
        name:'min',
        data: ['外圆车刀1', '端面车刀2', '切断刀3', '螺纹车刀4', '成形车刀5'],
        type: 'category'
    },
    series: [{
        data:mosun,
        type: 'bar',
        itemStyle: {
        normal: {
            color: function(params){
                return colors[params.dataIndex];
                // 取每条数据的 index 对应 colors 中的 index 返回这个颜色
        },
        }
         },
    }]

};
var j = 0;
var zhengdon = [0.11,0.931,0.102,0.115,0.091,0.124,0.112,0.097,0.141,0.016,  0.124,0.091,0.019,0.045,0,0.15,0.102,0.115,0.133,0.048,0.011,0.066,0.122,0.038,0.101,0.051,0.11,0.931,0.102,0.115,0.091,0.124,0.112,0.097,0.141,0.016,    0,0.121,0.038,0.123,0.045];
setInterval(function(){
    if (j<zhengdon.length){
        mosun.shift();
        mosun.unshift(400-(400-1000*zhengdon[j])/2);
        j++;
    }
    else{
        mosun.shift();
        mosun.unshift(400-(400-1000*zhengdon[0]));
        j=1;
    }
    myChart6.setOption(option6);
},1000);


    })
    {#饼状图2#}
    $(function () {
        var app = {};
    option5 = null;
    option5 = {
        title : {
            text: '机床检修',
            x:'center'
        },
        tooltip : {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        series : [
            {
                name: '检修情况',
                type: 'pie',
                radius : '55%',
                center: ['50%', '60%'],
                data:[
                    {value:1, name:'传动系统故障'},
                    {value:1, name:'控制系统故障'},
                    {value:3, name:'无故障'},
                ],
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
    };
    if (option5 && typeof option5 === "object") {
        myChart5.setOption(option5, true);
    }
    })
    {#饼状图时间分布1#}
    $(function () {
    var app = {};
    option4 = {
        title : {
            text: '机床时间分布（小时）',
            x:'center',
        },
        tooltip : {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        series : [
            {
                name: '访问来源',
                type: 'pie',
                radius : '55%',
                center: ['50%', '60%'],
                data:[
                    {value:335, name:'关机'},
                    {value:310, name:'待机'},
                    {value:50, name:'空切'},
                    {value:500, name:'切削'},
                ],
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                },
				pie1: {
					lable: {
						color:"#3398DB",
						fontFamily: "华文宋体",
					}
				}
            }
        ]
    };
    if (option4 && typeof option4 === "object") {
        myChart4.setOption(option4, true);
    }
    })
    $(function () {
    var app = {};
    app.title = '刀具使用时间';
    var tooltime = [150 , 330, 230, 180, 160]
    option3 = {
        color: ['#3398DB'],
        title:{
            x: 130,
            y: 25,
            text: '刀具使用时间',
			textStyle: {
				color:"#55557f",
				}
        },
        tooltip : {
            trigger: 'axis',
            axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
            }
        },
        grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
        },
        xAxis : [
            {
                type : 'category',

                data : ['外圆车刀1','端面车刀2','切断刀3',"螺纹车刀4","成形车刀5"],
                axisTick: {
                    alignWithLabel: true
                }
            }
        ],
        yAxis : [
            {
                type : 'value',
				name : '使用时间（min）',
				max : 400,
				min : 0
            }
        ],
        series : [
            {
                name:'直接访问',
                type:'bar',
                barWidth: '60%',
                data:tooltime
            }
        ]
    };
    var j = 0;
    var zhendongss = [0.11,0.931,0.102,0.115,0.091,0.124,0.112,0.097,0.141,0.016,  0.124,0.091,0.019,0.045,0,0.15,0.102,0.115,0.133,0.048,0.011,0.066,0.122,0.038,0.101,0.051,0.11,0.931,0.102,0.115,0.091,0.124,0.112,0.097,0.141,0.016,    0,0.121,0.038,0.123,0.045]
    setInterval(function(){
        if(j<zhendongss.length){
        tooltime.shift();
        tooltime.unshift(400-1000*zhendongss[j]);
        j++;
        }
        else{
        tooltime.shift();
        tooltime.unshift(400-1000*zhendongss[0]);
        j = 1;
        }
        myChart3.setOption(option3);
    },1000);

        myChart3.on('click', function(params) {
		console.log(params);
		var name = params.name;
		if (name == "外圆车刀"){
		window.open('tool.html');
		}
		else if (name == "外圆车刀2"){
		window.open('tool.html');
		}
		else if (name == "切断刀3"){
		window.open('tool.html');
		}
		else if (name == "螺纹车刀4"){
		window.open('tool.html');
		}
		else if (name == "成形车刀5"){
		window.open('tool.html');
		}
		//window.open(params.data.url);
	});
    })
    {#功耗图#}
    $(function()  {
        var app = {};
//    function randomData() {
//        now = new Date();
//        value = base + Math.random() * 21 ;
//        return {
//            name: now.toString(),
//            value: [
//                now,
//                Math.round(value)
//            ]
//        }
//    }

//    var data = [];
//    var now = +new Date(1997, 9, 3);
//    var oneDay = 24 * 3600 * 1000;
//    var base=800;
//    var value = Math.random() * 1000;
//    for (var i = 0; i < 1000; i++) {
//        data.push(randomData());
//    }
    var gonghao = [536.109,517.966,504.428,525.799,537.583,529.089,505.098,511.169,525.451,544.097,    528.215,520.07,512.773,542.654,524.47];
    var now = new Date();
    var atime = [];
    var myDates = new Date();
    var hh = myDates.getHours();
    var mm = myDates.getMinutes();
    var ss = myDates.getSeconds();
    var xDatas = hh +':' + mm + ':' + ss;
    for (var i = 0; i<15;i++){
        atime.unshift(xDatas);
        now = new Date(myDates - 2000);
    }

    option2 = {
        title: {
            x:240,
            y:0,
            text: '机床能耗',
			textStyle: {
				color:"#3398DB",
				}


        },
        tooltip: {
            trigger: 'axis',

            axisPointer: {
                animation: false
            }
        },
        xAxis: [{
            type: 'category',
            position:'top',
            show: true,
            data:atime,
            splitLine: {
                show: false
            }

        }],
        yAxis: {
            min:300,
            max:700,
            name:'功率',
            nameGap: '20',
            type: 'value',
            position:'right',
            boundaryGap: [0, '100%'],
            splitLine: {
                show: false
            }
        },

		dataZoom: [

		            {
		                type: 'inside',
		                start: 0,
		                end: 100
		            },

		        ],
        series: [{
            name: '功耗大小',
            type: 'line',
            showSymbol: false,
            hoverAnimation: true,
            data: gonghao,
            itemStyle: {
                normal: {
                color: "#386db3",//折线点的颜色
                lineStyle: {
                color: "red"//折线的颜色
                 }
            }}
        }]
    };
    //写入功耗数据
    var j = 0;
    var power = [542.952, 546.797, 535.13, 543.039, 526.186, 511.596, 546.422, 532.128, 525.359, 507.129, 544.896, 531.461, 528.004, 528.978, 548.094, 513.395, 503.058, 520.141, 532.782, 509.958, 524.953, 502.892, 525.894, 500.354, 521.873, 539.84, 536.868, 542.268, 514.335, 533.095];

    setInterval(function () {
        var myDate = new Date();
        var h = myDate.getHours();
        var m = myDate.getMinutes();
        var s = myDate.getSeconds();
        var xData = h +':' + m + ':' + s;
        atime.shift();
        atime.push(xData);
        if(j<25){
            gonghao.shift();
            gonghao.push(power[j]);
            j++
        }
        else{
            gonghao.shift();
            gonghao.push(power[0]);
            j = 1;
        }
        myChart2.setOption(option2);
        },1000);
        }
    )

    {##振动图#}
    $(function () {
        var app = {};
//    function randomData() {
//        now = new Date(+now + oneDay);
//        value = value + Math.random() * 21 - 10;
//        return {
//            name: now.toString(),
//            value: [
//                [now.getFullYear(), now.getMonth() + 1, now.getDate()].join('/'),
//                Math.round(value)
//            ]
//        }
//    }
//
//    var data = [];
//    var now = +new Date(2010, 9, 3);
//    var oneDay = 24 * 3600 * 1000;
//    var value = Math.random() * 1000;
//    for (var i = 0; i < 1000; i++) {
//        data.push(randomData());
//    }
    var zhendong = [0.11,0.931,-0.102,0.115,0.091,-0.124,-0.112,0.097,0.141,0.016,  -0.124,-0.091,0.019,0.045,0,0.15];
    var now = new Date();
    var atime = [];
    var myDates = new Date();
    var hh = myDates.getHours();
    var mm = myDates.getMinutes();
    var ss = myDates.getSeconds();
    var xDatas = hh +':' + mm + ':' + ss;
    for (var i = 0; i<15;i++){
        atime.unshift(xDatas);
        now = new Date(xDatas - 2000);
    }
    option1 = {
        title: {
            x:315,
            y:0,
            text: '振动',
			textStyle: {
				color:"#3398DB",
				}

        },
        tooltip: {
            trigger: 'axis',

            axisPointer: {
                animation: false
            }
        },
        xAxis: {
                        type : 'category',
                        boundaryGap : true,
                        data : atime
        },
        yAxis: {
            type: 'value',
            name:'震动(mm)',
            nameGap: '20',
            boundaryGap: [0, '100%'],
            splitLine: {
                show: false
            }
        },
		dataZoom: [

		            {
		                type: 'inside',
		                start: 0,
		                end: 100
		            },

		        ],
        series: [{
            name: '振动幅度',
            type: 'line',
            showSymbol: false,
            hoverAnimation: false,
            data: zhendong
        }]
    };
    //写入振动数组
    var j = 0;

    var zhendongs = [0.102,0.115,0.133,-0.048,0.011,0.066,0.122,0.038,-0.101,-0.051,0.11,0.931,-0.102,0.115,0.091,-0.124,-0.112,0.097,0.141,0.016,    0,0.121,0.038,-0.123,0.045,-0.124,-0.091,0.019,0.045,0,0.15]
    setInterval(function () {

        var myDate = new Date();
        var h = myDate.getHours();
        var m = myDate.getMinutes();
        var s = myDate.getSeconds();
        var xData = h +':' + m + ':' + s;

        atime.shift();
        atime.push(xData);
        if(j<30){
            zhendong.shift();
            zhendong.push(zhendongs[j]);
            j++
        }
        else{
        zhendong.shift();
        zhendong.push(zhendongs[0]);
        j = 1;
        }
        myChart1.setOption(option1);
    }, 1000);

}
    )
    {#产品合格率#}
        $(function () {
        var myChartrate = echarts.init(document.getElementById("surf_rate1"));
        var xdatarate = ['第五周','第四周','第三周','第二周','第一周'];
        var ydatarate = ['未统计',0.97,0.92,0.98,0.96];
        var optionrate = {
                title: {
                x:150,
                y:0,
                text: '周产品合格率',
                textStyle:{
                    fontSize:'25px',


                }
                },
                tooltip : {
                    trigger: 'axis'
                },
                xAxis:{
                    type : 'category',
                    boundaryGap : true,
                    data : xdatarate
                },
                yAxis:{
                    type : 'value',
                    name : '合格率',
                    max: 1,
                    min: 0,
                    boundaryGap: [0.2, 0.2]
                },
                series:[{

                    type:'bar',
                    data:ydatarate,
                    itemStyle: {
                        normal: {
                            //数值显示在柱状上方
                            label:{
                            show:true,
                            position:'top',
                            textStyle:{
                                color:'black',
                                fontSize:16
                            }
                            },
                            //每根柱子颜色设置
                            color: function(params) {
                                let colorList = [
                                    "#c23531",
                                    "#2f4554",
                                    "#61a0a8",
                                    "#d48265",
                                    "#91c7ae",
                                ];
                                return colorList[params.dataIndex];
                            }
                        }
                    },

        }]
        };

        myChartrate.setOption(optionrate);
                })
        </script>

</body>
</html>
